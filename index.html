<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nia Magaria</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.min.js"></script>
  <style>
    body { margin: 0; padding: 0; overflow: hidden; background: #050505; }
    canvas { display: block; }
    #overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      color: white; font-family: sans-serif; font-size: 24px;
      background: rgba(0,0,0,0.8); cursor: pointer; z-index: 10;
    }
  </style>
</head>
<body>

<div id="overlay">Happy Birthday GIIIRL</div>

<script>
  let myFont;
  let song;
  let amplitude;
  let displayText = "NIA MAGARIA"; 
  let spacing = 30; // Space between repeated text
  
  function preload() {
    song = loadSound('mysong.mp3');
    myFont = loadFont('OstrichSansInline-Italic.ttf'); 
  }

  function setup() {
    createCanvas(windowWidth, windowHeight);
    amplitude = new p5.Amplitude();
    textAlign(CENTER, CENTER);
    rectMode(CENTER);
    
    // LOWER VOLUME HERE (0.0 to 1.0)
    song.setVolume(0.2); 

    let overlay = document.getElementById('overlay');
    overlay.addEventListener('click', () => {
      if (!song.isPlaying()) {
        song.play();
        overlay.style.display = 'none';
      }
    });
  }

function draw() {
    textFont(myFont);
    background(10, 10, 15); 

    let level = amplitude.getLevel();
    let speed = 2;
    let unitWidth = textWidth(displayText) + spacing;
    let copies = width / unitWidth + 2; 
    let rowHeight = 60;
    // 1. BACKGROUND (Scrolling Rows)
    textSize(40);
    for (let i = 0; i < (height / rowHeight + 2); i++) {
      let y = i * rowHeight;
      let direction = (i % 2 === 0) ? 1 : -1; 
      let currentOffset = (frameCount * speed * direction) % unitWidth;
      if (direction === -1 && currentOffset > 0) currentOffset -= unitWidth;

      fill(255, 255, 255, 30); 
      for (let j = -1; j < copies; j++) {
        text(displayText, (j * unitWidth) + currentOffset, y);
      }
    }

    // 2. CENTER TEXT WITH PULSATING GLOW
    push(); // Start a new drawing state
    translate(width / 2, height / 2);
    textSize(80);
    
    // Calculate Glow Intensity based on music
    // 10 is the minimum glow, 150 is the max glow on big beats
    let glowSize = map(level, 0, 0.3, 40, 250); 
    
    // Set the Glow properties
    drawingContext.shadowBlur = glowSize;
    drawingContext.shadowColor = color(0, 255, 200); // Neon Cyan
    
    // Draw the main text (it stays the same size now!)
    fill(255); 
    stroke(0, 255, 200);
    strokeWeight(2);
    text(displayText, 0, 0);
    
    // Optional: Layer a second "heavy" glow for extra brightness
    drawingContext.shadowBlur = glowSize / 2;
    text(displayText, 0, 0);
    
    pop(); // Restore drawing state
  }

  function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
  }
</script>

</body>
</html>